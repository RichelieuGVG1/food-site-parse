Описание
Этот скрипт предназначен для парсинга рецептов с сайта food.ru. Он собирает информацию по категориям рецептов, по страницам каждого рецепта, и сохраняет важные данные о каждом рецепте в формате словаря. Скрипт может работать с несколькими потоками для повышения производительности.

Основные функции:
scrape_pages() — основная функция, которая парсит рецепты с разных страниц, извлекая категории, количество страниц и URL рецептов.
parse_recipe_details(recipe_soup, category) — извлекает данные из каждого рецепта: название, категорию, описание, состав, макросы, время приготовления и другие атрибуты.
Работа с Excel — данные рецептов записываются в файл dishes.xlsx, который содержит информацию о блюде, категории, описании, макроэлементах и ингредиентах.
Установка и запуск
Зависимости
Перед запуском необходимо установить необходимые библиотеки:

bash
```
pip install requests beautifulsoup4 openpyxl
Запуск скрипта
Клонируйте репозиторий или скачайте скрипт.
Убедитесь, что в папке находится файл dishes.xlsx, с которым будет работать скрипт.
Запустите скрипт с помощью команды:
bash
Копировать код
python your_script_name.py
Структура данных
Парсинг каждого рецепта собирает следующие данные:

title — Название блюда.
category — Категория блюда (например, закуски, салаты).
description — Описание рецепта.
nutrients — Макроэлементы (калории, белки, жиры, углеводы).
ingredients — Ингредиенты и их количество, которые корректируются в зависимости от порции.
time — Время готовности и время на кухне.
Использование многопоточности
Скрипт поддерживает многопоточность для ускорения парсинга большого количества страниц. Запуск многопоточной версии скрипта:
```
python
```
from concurrent.futures import ThreadPoolExecutor
```
# Запуск функции scrape_pages в несколько потоков
```
with ThreadPoolExecutor(max_workers=5) as executor:
    executor.submit(scrape_pages)
   ```
Заполнение Excel
Скрипт открывает файл dishes.xlsx и записывает туда данные по каждому рецепту. Перед записью проверяется, существует ли уже рецепт в таблице. Если нет, данные добавляются в первую незаполненную строку.

Файл dishes.xlsx должен содержать следующие колонки:

dish — Название блюда.
category — Категория.
description — Описание.
macros — Макроэлементы (словарь).
ingredients — Ингредиенты (словарь).
allergy — Свойства блюда.
Особенности
Скрипт автоматически обрабатывает ингредиенты, корректирует их значения в зависимости от порции блюда.
Парсит время готовки и время на кухне.
Работает с различными типами данных, включая числа с точкой или запятой.
Примечание
При парсинге изображений скрипт находит последний тег <img> с соответствующим alt-тегом и извлекает ссылку на изображение блюда.